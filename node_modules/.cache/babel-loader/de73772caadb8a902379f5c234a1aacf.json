{"ast":null,"code":"import _regeneratorRuntime from \"/Applications/XAMPP/voxel-interface/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Applications/XAMPP/voxel-interface/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"/Applications/XAMPP/voxel-interface/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _taggedTemplateLiteral from \"/Applications/XAMPP/voxel-interface/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";\n\nvar _jsxFileName = \"/Applications/XAMPP/voxel-interface/src/pages/Campaign/ModalRegisterCampaignCaptcha.tsx\",\n    _templateObject,\n    _this = this,\n    _s = $RefreshSig$();\n\nimport { Trans } from \"@lingui/react\";\nimport axios from 'axios';\nimport { createRef, memo, useCallback } from 'react';\nimport ReCAPTCHA from 'react-google-recaptcha';\nimport { Text } from 'rebass';\nimport styled from 'styled-components';\nimport { mutate } from 'swr';\nimport { ModalCenter } from 'components/Modal';\nimport { GOOGLE_RECAPTCHA_KEY } from 'constants/env';\nimport { CAMPAIGN_BASE_URL, SWR_KEYS } from 'constants/index';\nimport { useActiveWeb3React } from 'hooks';\nimport useTheme from 'hooks/useTheme';\nimport { ApplicationModal } from 'state/application/actions';\nimport { useModalOpen, useRegisterCampaignCaptchaModalToggle, useRegisterCampaignSuccessModalToggle } from 'state/application/hooks';\nimport { useRecaptchaCampaignManager } from 'state/campaigns/hooks';\nimport { useIsDarkMode } from 'state/user/hooks';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar Background = styled.div.withConfig({\n  displayName: \"ModalRegisterCampaignCaptcha__Background\",\n  componentId: \"sc-14savuo-0\"\n})([\"background-color:\", \";width:400px;text-align:center;padding:50px 20px;border-radius:20px;display:flex;justify-content:center;align-items:center;gap:25px;flex-direction:column;\", \"\"], function (_ref) {\n  var theme = _ref.theme;\n  return theme.tableHeader;\n}, function (_ref2) {\n  var theme = _ref2.theme;\n  return theme.mediaWidth.upToSmall(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n    padding: 30px 20px;\\n  \"])));\n});\n_c = Background;\n\nvar ModalRegisterCampaignCaptcha = function ModalRegisterCampaignCaptcha() {\n  _s();\n\n  var recaptchaRef = /*#__PURE__*/createRef();\n  var isRegisterCampaignCaptchaModalOpen = useModalOpen(ApplicationModal.REGISTER_CAMPAIGN_CAPTCHA);\n  var toggleRegisterCampaignCaptchaModal = useRegisterCampaignCaptchaModalToggle();\n  var toggleRegisterCampaignSuccessModal = useRegisterCampaignSuccessModalToggle();\n\n  var _useRecaptchaCampaign = useRecaptchaCampaignManager(),\n      _useRecaptchaCampaign2 = _slicedToArray(_useRecaptchaCampaign, 3),\n      recaptchaCampaign = _useRecaptchaCampaign2[0],\n      updateRecaptchaCampaignId = _useRecaptchaCampaign2[1],\n      updateRecaptchaCampaignLoading = _useRecaptchaCampaign2[2];\n\n  var isDarkMode = useIsDarkMode();\n  var theme = useTheme();\n\n  var _useActiveWeb3React = useActiveWeb3React(),\n      account = _useActiveWeb3React.account; // Create an event handler, so you can call the verification on button click event or form submit\n\n\n  var handleReCaptchaVerify = useCallback( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n    var token, response;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (!(!recaptchaCampaign.id || !account)) {\n              _context.next = 2;\n              break;\n            }\n\n            return _context.abrupt(\"return\");\n\n          case 2:\n            if (!(typeof recaptchaRef === 'function')) {\n              _context.next = 5;\n              break;\n            }\n\n            console.log(\"recaptchaRef is a function? Something's wrong.\");\n            return _context.abrupt(\"return\");\n\n          case 5:\n            if (!(!recaptchaRef || !recaptchaRef.current)) {\n              _context.next = 8;\n              break;\n            }\n\n            console.log('Execute recaptcha not yet available');\n            return _context.abrupt(\"return\");\n\n          case 8:\n            _context.prev = 8;\n            updateRecaptchaCampaignLoading(true);\n            _context.next = 12;\n            return recaptchaRef.current.getValue();\n\n          case 12:\n            token = _context.sent;\n            _context.next = 15;\n            return new Promise(function (r) {\n              return setTimeout(r, 750);\n            });\n\n          case 15:\n            toggleRegisterCampaignCaptchaModal();\n            _context.next = 18;\n            return axios({\n              method: 'POST',\n              url: \"\".concat(CAMPAIGN_BASE_URL, \"/\").concat(recaptchaCampaign.id, \"/participants\"),\n              data: {\n                token: token,\n                address: account\n              }\n            });\n\n          case 18:\n            response = _context.sent;\n\n            if (!(response.status === 200)) {\n              _context.next = 23;\n              break;\n            }\n\n            _context.next = 22;\n            return mutate([SWR_KEYS.getListCampaign, account]);\n\n          case 22:\n            toggleRegisterCampaignSuccessModal();\n\n          case 23:\n            _context.next = 28;\n            break;\n\n          case 25:\n            _context.prev = 25;\n            _context.t0 = _context[\"catch\"](8);\n            console.error(_context.t0);\n\n          case 28:\n            _context.prev = 28;\n            updateRecaptchaCampaignLoading(false);\n            updateRecaptchaCampaignId(undefined);\n            return _context.finish(28);\n\n          case 32:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[8, 25, 28, 32]]);\n  })), [account, recaptchaCampaign.id, recaptchaRef, toggleRegisterCampaignCaptchaModal, toggleRegisterCampaignSuccessModal, updateRecaptchaCampaignId, updateRecaptchaCampaignLoading]);\n  return /*#__PURE__*/_jsxDEV(ModalCenter, {\n    isOpen: isRegisterCampaignCaptchaModalOpen,\n    onDismiss: function onDismiss() {\n      toggleRegisterCampaignCaptchaModal();\n      updateRecaptchaCampaignId(undefined);\n    },\n    maxWidth: \"calc(100vw - 32px)\",\n    width: \"fit-content\",\n    height: \"fit-content\",\n    bgColor: \"transparent\",\n    children: /*#__PURE__*/_jsxDEV(Background, {\n      children: [/*#__PURE__*/_jsxDEV(Text, {\n        color: theme.text,\n        children: /*#__PURE__*/_jsxDEV(Trans, {\n          id: \"To continue, check the box below to verify and proceed\"\n        }, void 0, false, void 0, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(ReCAPTCHA, {\n        ref: recaptchaRef,\n        size: \"normal\",\n        sitekey: GOOGLE_RECAPTCHA_KEY,\n        onChange: handleReCaptchaVerify,\n        theme: isDarkMode ? 'dark' : 'light',\n        style: {\n          minHeight: '78px'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 99,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(ModalRegisterCampaignCaptcha, \"QYxHTKtCMu8T68Z50162XdRBzao=\", false, function () {\n  return [useModalOpen, useRegisterCampaignCaptchaModalToggle, useRegisterCampaignSuccessModalToggle, useRecaptchaCampaignManager, useIsDarkMode, useTheme, useActiveWeb3React];\n});\n\n_c2 = ModalRegisterCampaignCaptcha;\nexport default _c3 = /*#__PURE__*/memo(ModalRegisterCampaignCaptcha);\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"Background\");\n$RefreshReg$(_c2, \"ModalRegisterCampaignCaptcha\");\n$RefreshReg$(_c3, \"%default%\");","map":{"version":3,"names":["axios","createRef","memo","useCallback","ReCAPTCHA","Text","styled","mutate","ModalCenter","GOOGLE_RECAPTCHA_KEY","CAMPAIGN_BASE_URL","SWR_KEYS","useActiveWeb3React","useTheme","ApplicationModal","useModalOpen","useRegisterCampaignCaptchaModalToggle","useRegisterCampaignSuccessModalToggle","useRecaptchaCampaignManager","useIsDarkMode","Background","div","theme","tableHeader","mediaWidth","upToSmall","ModalRegisterCampaignCaptcha","recaptchaRef","isRegisterCampaignCaptchaModalOpen","REGISTER_CAMPAIGN_CAPTCHA","toggleRegisterCampaignCaptchaModal","toggleRegisterCampaignSuccessModal","recaptchaCampaign","updateRecaptchaCampaignId","updateRecaptchaCampaignLoading","isDarkMode","account","handleReCaptchaVerify","id","console","log","current","getValue","token","Promise","r","setTimeout","method","url","data","address","response","status","getListCampaign","error","undefined","text","minHeight"],"sources":["/Applications/XAMPP/voxel-interface/src/pages/Campaign/ModalRegisterCampaignCaptcha.tsx"],"sourcesContent":["import { Trans } from '@lingui/macro'\nimport axios from 'axios'\nimport { createRef, memo, useCallback } from 'react'\nimport ReCAPTCHA from 'react-google-recaptcha'\nimport { Text } from 'rebass'\nimport styled from 'styled-components'\nimport { mutate } from 'swr'\n\nimport { ModalCenter } from 'components/Modal'\nimport { GOOGLE_RECAPTCHA_KEY } from 'constants/env'\nimport { CAMPAIGN_BASE_URL, SWR_KEYS } from 'constants/index'\nimport { useActiveWeb3React } from 'hooks'\nimport useTheme from 'hooks/useTheme'\nimport { ApplicationModal } from 'state/application/actions'\nimport {\n  useModalOpen,\n  useRegisterCampaignCaptchaModalToggle,\n  useRegisterCampaignSuccessModalToggle,\n} from 'state/application/hooks'\nimport { useRecaptchaCampaignManager } from 'state/campaigns/hooks'\nimport { useIsDarkMode } from 'state/user/hooks'\n\nconst Background = styled.div`\n  background-color: ${({ theme }) => theme.tableHeader};\n  width: 400px;\n  text-align: center;\n  padding: 50px 20px;\n  border-radius: 20px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  gap: 25px;\n  flex-direction: column;\n  ${({ theme }) => theme.mediaWidth.upToSmall`\n    padding: 30px 20px;\n  `}\n`\n\nconst ModalRegisterCampaignCaptcha = () => {\n  const recaptchaRef = createRef<ReCAPTCHA>()\n\n  const isRegisterCampaignCaptchaModalOpen = useModalOpen(ApplicationModal.REGISTER_CAMPAIGN_CAPTCHA)\n  const toggleRegisterCampaignCaptchaModal = useRegisterCampaignCaptchaModalToggle()\n  const toggleRegisterCampaignSuccessModal = useRegisterCampaignSuccessModalToggle()\n  const [recaptchaCampaign, updateRecaptchaCampaignId, updateRecaptchaCampaignLoading] = useRecaptchaCampaignManager()\n  const isDarkMode = useIsDarkMode()\n  const theme = useTheme()\n\n  const { account } = useActiveWeb3React()\n\n  // Create an event handler, so you can call the verification on button click event or form submit\n  const handleReCaptchaVerify = useCallback(async () => {\n    if (!recaptchaCampaign.id || !account) return\n\n    if (typeof recaptchaRef === 'function') {\n      console.log(\"recaptchaRef is a function? Something's wrong.\")\n      return\n    }\n\n    if (!recaptchaRef || !recaptchaRef.current) {\n      console.log('Execute recaptcha not yet available')\n      return\n    }\n\n    try {\n      updateRecaptchaCampaignLoading(true)\n      const token = await recaptchaRef.current.getValue()\n      await new Promise(r => setTimeout(r, 750))\n      toggleRegisterCampaignCaptchaModal()\n      const response = await axios({\n        method: 'POST',\n        url: `${CAMPAIGN_BASE_URL}/${recaptchaCampaign.id}/participants`,\n        data: {\n          token,\n          address: account,\n        },\n      })\n      if (response.status === 200) {\n        await mutate([SWR_KEYS.getListCampaign, account])\n        toggleRegisterCampaignSuccessModal()\n      }\n    } catch (err) {\n      console.error(err)\n    } finally {\n      updateRecaptchaCampaignLoading(false)\n      updateRecaptchaCampaignId(undefined)\n    }\n  }, [\n    account,\n    recaptchaCampaign.id,\n    recaptchaRef,\n    toggleRegisterCampaignCaptchaModal,\n    toggleRegisterCampaignSuccessModal,\n    updateRecaptchaCampaignId,\n    updateRecaptchaCampaignLoading,\n  ])\n\n  return (\n    <ModalCenter\n      isOpen={isRegisterCampaignCaptchaModalOpen}\n      onDismiss={() => {\n        toggleRegisterCampaignCaptchaModal()\n        updateRecaptchaCampaignId(undefined)\n      }}\n      maxWidth=\"calc(100vw - 32px)\"\n      width=\"fit-content\"\n      height=\"fit-content\"\n      bgColor=\"transparent\"\n    >\n      <Background>\n        <Text color={theme.text}>\n          <Trans>To continue, check the box below to verify and proceed</Trans>\n        </Text>\n        <ReCAPTCHA\n          ref={recaptchaRef}\n          size=\"normal\"\n          sitekey={GOOGLE_RECAPTCHA_KEY}\n          onChange={handleReCaptchaVerify}\n          theme={isDarkMode ? 'dark' : 'light'}\n          style={{ minHeight: '78px' }}\n        />\n      </Background>\n    </ModalCenter>\n  )\n}\n\nexport default memo(ModalRegisterCampaignCaptcha)\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}