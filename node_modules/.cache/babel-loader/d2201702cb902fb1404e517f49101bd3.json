{"ast":null,"code":"import _regeneratorRuntime from \"/Applications/XAMPP/voxel-interface/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Applications/XAMPP/voxel-interface/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"/Applications/XAMPP/voxel-interface/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\n\nvar _s = $RefreshSig$();\n\nimport { useEffect, useMemo, useState } from 'react';\nimport useParsedQueryString from 'hooks/useParsedQueryString';\nimport { TrueSightTabs, TrueSightTimeframe } from 'pages/TrueSight/index';\nexport default function useGetTokensForSearchBox(searchText, timeframe, isShowTrueSightOnly) {\n  _s();\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      data = _useState2[0],\n      setData = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      isLoading = _useState4[0],\n      setIsLoading = _useState4[1];\n\n  var _useState5 = useState(),\n      _useState6 = _slicedToArray(_useState5, 2),\n      error = _useState6[0],\n      setError = _useState6[1];\n\n  var _useParsedQueryString = useParsedQueryString(),\n      tab = _useParsedQueryString.tab;\n\n  useEffect(function () {\n    var fetchData = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var timeframeStr, url, response, _rawResult$tokens, json, rawResult;\n\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!(searchText && tab)) {\n                  _context.next = 24;\n                  break;\n                }\n\n                _context.prev = 1;\n                timeframeStr = timeframe === TrueSightTimeframe.ONE_DAY ? '24h' : '7d';\n                url = \"\".concat(process.env.REACT_APP_TRUESIGHT_API, \"/api/v1/\").concat(tab === TrueSightTabs.TRENDING_SOON ? 'trending-soon' : 'trending', \"?timeframe=\").concat(timeframeStr, \"&page_number=\", 0, \"&page_size=\", 5, \"&search_token_name=\").concat(searchText);\n                setError(undefined);\n                setIsLoading(true);\n                _context.next = 8;\n                return fetch(url);\n\n              case 8:\n                response = _context.sent;\n\n                if (!response.ok) {\n                  _context.next = 16;\n                  break;\n                }\n\n                _context.next = 12;\n                return response.json();\n\n              case 12:\n                json = _context.sent;\n                rawResult = json.data;\n                rawResult.tokens = isShowTrueSightOnly ? rawResult.tokens.filter(function (token) {\n                  return token.discovered_on > 0;\n                }) : rawResult.tokens;\n                setData((_rawResult$tokens = rawResult.tokens) !== null && _rawResult$tokens !== void 0 ? _rawResult$tokens : []);\n\n              case 16:\n                setIsLoading(false);\n                _context.next = 24;\n                break;\n\n              case 19:\n                _context.prev = 19;\n                _context.t0 = _context[\"catch\"](1);\n                console.error(_context.t0);\n                setError(_context.t0);\n                setIsLoading(false);\n\n              case 24:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[1, 19]]);\n      }));\n\n      return function fetchData() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    fetchData();\n  }, [isShowTrueSightOnly, searchText, tab, timeframe]);\n  return useMemo(function () {\n    return {\n      isLoading: isLoading,\n      data: data,\n      error: error\n    };\n  }, [data, isLoading, error]);\n}\n\n_s(useGetTokensForSearchBox, \"aXXBMXIAek1Es+wAuzn42VFpt8Q=\", false, function () {\n  return [useParsedQueryString];\n});","map":{"version":3,"names":["useEffect","useMemo","useState","useParsedQueryString","TrueSightTabs","TrueSightTimeframe","useGetTokensForSearchBox","searchText","timeframe","isShowTrueSightOnly","data","setData","isLoading","setIsLoading","error","setError","tab","fetchData","timeframeStr","ONE_DAY","url","process","env","REACT_APP_TRUESIGHT_API","TRENDING_SOON","undefined","fetch","response","ok","json","rawResult","tokens","filter","token","discovered_on","console"],"sources":["/Applications/XAMPP/voxel-interface/src/pages/TrueSight/hooks/useGetTokensForSearchBox.ts"],"sourcesContent":["import { useEffect, useMemo, useState } from 'react'\n\nimport useParsedQueryString from 'hooks/useParsedQueryString'\nimport { TrueSightTokenData } from 'pages/TrueSight/hooks/useGetTrendingSoonData'\nimport { TrueSightTabs, TrueSightTimeframe } from 'pages/TrueSight/index'\n\nexport default function useGetTokensForSearchBox(\n  searchText: string,\n  timeframe: TrueSightTimeframe,\n  isShowTrueSightOnly: boolean,\n) {\n  const [data, setData] = useState<TrueSightTokenData[]>([])\n  const [isLoading, setIsLoading] = useState(false)\n  const [error, setError] = useState<Error>()\n\n  const { tab } = useParsedQueryString()\n\n  useEffect(() => {\n    const fetchData = async () => {\n      if (searchText && tab) {\n        try {\n          const timeframeStr = timeframe === TrueSightTimeframe.ONE_DAY ? '24h' : '7d'\n          const url = `${process.env.REACT_APP_TRUESIGHT_API}/api/v1/${\n            tab === TrueSightTabs.TRENDING_SOON ? 'trending-soon' : 'trending'\n          }?timeframe=${timeframeStr}&page_number=${0}&page_size=${5}&search_token_name=${searchText}`\n          setError(undefined)\n          setIsLoading(true)\n          const response = await fetch(url)\n          if (response.ok) {\n            const json = await response.json()\n            const rawResult = json.data\n            rawResult.tokens = isShowTrueSightOnly\n              ? rawResult.tokens.filter((token: TrueSightTokenData) => token.discovered_on > 0)\n              : rawResult.tokens\n            setData(rawResult.tokens ?? [])\n          }\n          setIsLoading(false)\n        } catch (err) {\n          console.error(err)\n          setError(err)\n          setIsLoading(false)\n        }\n      }\n    }\n\n    fetchData()\n  }, [isShowTrueSightOnly, searchText, tab, timeframe])\n\n  return useMemo(() => ({ isLoading, data, error }), [data, isLoading, error])\n}\n"],"mappings":";;;;;;AAAA,SAASA,SAAT,EAAoBC,OAApB,EAA6BC,QAA7B,QAA6C,OAA7C;AAEA,OAAOC,oBAAP,MAAiC,4BAAjC;AAEA,SAASC,aAAT,EAAwBC,kBAAxB,QAAkD,uBAAlD;AAEA,eAAe,SAASC,wBAAT,CACbC,UADa,EAEbC,SAFa,EAGbC,mBAHa,EAIb;EAAA;;EACA,gBAAwBP,QAAQ,CAAuB,EAAvB,CAAhC;EAAA;EAAA,IAAOQ,IAAP;EAAA,IAAaC,OAAb;;EACA,iBAAkCT,QAAQ,CAAC,KAAD,CAA1C;EAAA;EAAA,IAAOU,SAAP;EAAA,IAAkBC,YAAlB;;EACA,iBAA0BX,QAAQ,EAAlC;EAAA;EAAA,IAAOY,KAAP;EAAA,IAAcC,QAAd;;EAEA,4BAAgBZ,oBAAoB,EAApC;EAAA,IAAQa,GAAR,yBAAQA,GAAR;;EAEAhB,SAAS,CAAC,YAAM;IACd,IAAMiB,SAAS;MAAA,sEAAG;QAAA;;QAAA;UAAA;YAAA;cAAA;gBAAA,MACZV,UAAU,IAAIS,GADF;kBAAA;kBAAA;gBAAA;;gBAAA;gBAGNE,YAHM,GAGSV,SAAS,KAAKH,kBAAkB,CAACc,OAAjC,GAA2C,KAA3C,GAAmD,IAH5D;gBAINC,GAJM,aAIGC,OAAO,CAACC,GAAR,CAAYC,uBAJf,qBAKVP,GAAG,KAAKZ,aAAa,CAACoB,aAAtB,GAAsC,eAAtC,GAAwD,UAL9C,wBAMEN,YANF,mBAM8B,CAN9B,iBAM6C,CAN7C,gCAMoEX,UANpE;gBAOZQ,QAAQ,CAACU,SAAD,CAAR;gBACAZ,YAAY,CAAC,IAAD,CAAZ;gBARY;gBAAA,OASWa,KAAK,CAACN,GAAD,CAThB;;cAAA;gBASNO,QATM;;gBAAA,KAURA,QAAQ,CAACC,EAVD;kBAAA;kBAAA;gBAAA;;gBAAA;gBAAA,OAWSD,QAAQ,CAACE,IAAT,EAXT;;cAAA;gBAWJA,IAXI;gBAYJC,SAZI,GAYQD,IAAI,CAACnB,IAZb;gBAaVoB,SAAS,CAACC,MAAV,GAAmBtB,mBAAmB,GAClCqB,SAAS,CAACC,MAAV,CAAiBC,MAAjB,CAAwB,UAACC,KAAD;kBAAA,OAA+BA,KAAK,CAACC,aAAN,GAAsB,CAArD;gBAAA,CAAxB,CADkC,GAElCJ,SAAS,CAACC,MAFd;gBAGApB,OAAO,sBAACmB,SAAS,CAACC,MAAX,iEAAqB,EAArB,CAAP;;cAhBU;gBAkBZlB,YAAY,CAAC,KAAD,CAAZ;gBAlBY;gBAAA;;cAAA;gBAAA;gBAAA;gBAoBZsB,OAAO,CAACrB,KAAR;gBACAC,QAAQ,aAAR;gBACAF,YAAY,CAAC,KAAD,CAAZ;;cAtBY;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA,CAAH;;MAAA,gBAATI,SAAS;QAAA;MAAA;IAAA,GAAf;;IA2BAA,SAAS;EACV,CA7BQ,EA6BN,CAACR,mBAAD,EAAsBF,UAAtB,EAAkCS,GAAlC,EAAuCR,SAAvC,CA7BM,CAAT;EA+BA,OAAOP,OAAO,CAAC;IAAA,OAAO;MAAEW,SAAS,EAATA,SAAF;MAAaF,IAAI,EAAJA,IAAb;MAAmBI,KAAK,EAALA;IAAnB,CAAP;EAAA,CAAD,EAAqC,CAACJ,IAAD,EAAOE,SAAP,EAAkBE,KAAlB,CAArC,CAAd;AACD;;GA3CuBR,wB;UASNH,oB"},"metadata":{},"sourceType":"module"}